<html lang="en">

<head>
    <script type="text/javascript"></script>
    <meta charset="UTF-8">
    <title>地图测量工具 by:帅帅[微信：yanyeshuai]</title>
</head>

<script>
    var ClickCount = 0;
    var StartX, StartY, EndX, EndY;
    var DisX, DisY, Dis;

    window.onload = function () {
        var ctx = document.getElementById("canvas").getContext('2d');
        var img = new Image();
        img.src = '2022小学组-园艺机器人.jpg';
        img.onload = function () {
            ctx.drawImage(img, 0, 0, 1180, 571.5);
        }

        document.getElementById('canvas').onclick = function (e) {
            ClickCount = ClickCount + 1;
            e = e || window.event;
            var x = e.offsetX || e.layerX,
                y = e.offsetY || e.layerY;

            if (ClickCount == 1) {

                ctx.clearRect(0, 0, 1180, 571.5)
                ctx.drawImage(img, 0, 0, 1180, 571.5);

                StartX = x;
                StartY = y;
                ctx.fillStyle = "Blue";
                ctx.fillRect(x - 5, y - 5, 10, 10);
            }

            if (ClickCount == 2) {
                EndX = x;
                EndY = y;
                ctx.fillStyle = "Red";
                ctx.fillRect(x - 5, y - 5, 10, 10);

                ctx.strokeStyle = "Purple";
                ctx.beginPath();
                ctx.moveTo(StartX, StartY);
                ctx.lineTo(StartX, EndY);
                ctx.lineTo(EndX, EndY);
                ctx.closePath();
                ctx.stroke();

                ClickCount = 0;
                DisX = Math.abs((StartX - EndX) * 2);
                DisY = Math.abs((StartY - EndY) * 2);
                Dis = Math.abs(Math.sqrt(DisX * DisX + DisY * DisY));
                Dis = Dis.toFixed(2)

                document.getElementById("dis").innerHTML = Dis + 'mm';
                document.getElementById("dis_x").innerHTML = DisX + 'mm';
                document.getElementById("dis_y").innerHTML = DisY + 'mm';
                //alert(ClickCount)
            }
        }

    }
</script>

<body>
    <div style="text-align:center; vertical-align:middle;">
        <p>在地图上两个位置点击左键，下方表格查看距离</p>
        <p>Click the left button in two places on the map and view the distance in the table below.</p>
        <canvas id="canvas" style="border: 4px solid #999;" width="1180" height="571.5"></canvas>
        <p> </p>
        <table border="3" style="text-align:center; vertical-align:middle; margin:auto;">
            <tr>
                <td>横向距离</td>
                <td>纵向距离</td>
                <td>距离</td>
            </tr>
            <tr>
                <td>Transverse distance</td>
                <td>Longitudinal distance</td>
                <td>Distance</td>
            </tr>
            <tr>
                <td id='dis_x'> 横向距离 </td>
                <td id='dis_y'> 纵向距离 </td>
                <td id='dis'> 距离 </td>
            </tr>
        </table>
        <p> 如有问题，请联系微信：帅帅[微信：yanyeshuai]</p>
    </div>
</body>

</html>
